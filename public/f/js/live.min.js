(function(e){function t(e,t){if(0!=e.b){if(A.alertResult){var n={id:+new Date,type:"result",user:{name:"System"},time:Math.floor(+new Date/1e3),result:e};V(n)}A.alertRecord&&(""!=e.sr||e.ar)}}function n(){N.loading||(k.dispatch("LOADING_RESULTS"),w.send({type:"result",action:"fetch",params:{event:N.params.e,round:N.params.r,filter:N.params.filter}}))}function r(e){return D[e.e]}function s(e){return I[e.e][e.r]}function a(e){return U[e]||{}}function i(e){var t,n,r=999999999,a=0,i=!0,o=0,u=0,c=0,l=s(e),f=l.f,m="a"==f||""==f?5:"m"==f?3:parseInt(f);for(t=0;t<m;t++)n=e.v[t],c+=n,n>0&&n<r&&(r=n),0==n&&u++,n<0?(o++,a=n):n>a&&a>=0&&(a=n);e.b=r,999999999===e.b&&(e.b=0==a?0:-1),""==f&&(i=!1),("a"==f||"m"==f)&&u>0&&(i=!1),(o>1||1==o&&("m"==f||"3"==f))&&(i=!1),("1"==f||"2"==f||"3"==f&&!d(e.e))&&(i=!1),u>0&&(i=!1),i?("m"==f||"3"==f?("333fm"===e.e&&(c*=100),e.a=Math.round(c/3)):e.a=Math.round((c-r-a)/3),e.a/100>=600&&(e.a=100*Math.round(e.a/100))):"m"==f||"a"==f?e.a=u>0?0:-1:(d(e.e)||""==f)&&(e.a=0)}function o(e,t,n,r,s){if("DNF"===e)return-1;if("DNS"===e)return-2;if(""===e)return 0;if("333fm"===t)return n?100*parseFloat(e):parseInt(e);if("333mbf"===t){var a=r-s,i=s-a;if(a>s||s<2)return-1;var o=e.match(/(?:(\d+)?:)?(\d{1,2})/);if(!o)return 0;var u=o[1]?parseInt(o[1]):0,c=parseInt(o[2]);return c=Math.min(60*u+c,600*Math.min(6,r)+2*s),1e7*(99-i)+100*c+a}o=e.match(/(?:(\d+)?:)?(\d{1,2})\.(\d{1,2})/);if(!o)return 0;u=o[1]?parseInt(o[1]):0,c=parseInt(o[2]);var l=parseInt(o[3]);return 60*u+c>=600&&(l=0),100*(60*u+c)+l}function u(e,t){var n;if(0==e||null==e)return"";if(e=parseInt(e),-1==e)return"DNF";if(-2==e)return"DNS";if("333fm"===t)n=e>1e3?(e/100).toFixed(2):e+"";else if("333mbf"===t){var r=99-Math.floor(e/1e7),s=e%100;n=r+s+"/"+(r+2*s)+" "+c(Math.floor(e/100)%1e5,!0)}else{var a=e%100,i=Math.floor(e/100);a<10&&(a="0"+a),n=c(i)+"."+a}return n}function c(e,t){if(t&&99999==e)return"unknown";e=parseInt(e);var n=Math.floor(e/60),r=Math.floor(n/60);e%=60,n%=60;var s=[e];1==r&&(n+=60,r=0),r>0?s.push(n,r):(n>0||t)&&s.push(n);for(var a=1;a<s.length;a++)s[a-1]<10&&(s[a-1]="0"+s[a-1]);return s.reverse().join(":")}function l(e,t){for(var n,r,s=0,a=e.length-1;s<=a;)n=s+a>>1,r=p(t,e[n],!0),r<0?a=n-1:s=n+1;return s}function f(e,t){for(var n=0,r=e.length;n<r;n++)0==n||p(e[n-1],e[n],!0)<0?e[n].p=n+1:e[n].p=e[n-1].p,0==e[n].b&&(e[n].p="-"),e[n].isRepeated=!1,n>0&&m(e[n-1],e[n])&&(e[n-1].isRepeated=!0,e[n].isRepeated=!0),e[n].isNew=e[n]===t}function d(e){return["333bf","444bf","555bf"].indexOf(e)>-1}function m(e,t){if("333fm"===e.e)return!1;for(var n=0,r=s(e),a=r.f,i="a"==a||""==a?5:"m"==a?3:parseInt(a),o="a"==a?2:1,u=!1,c=0,l=0;l<i;l++)e.v[l]>0&&e.v[l]==t.v[l]&&n++,e.v[l]>0&&e.v[l]/100<r.co&&(u=!0),e.v[l]<0&&c++;return 0!=n&&(n>=.6*i||!u&&n>=o-c)}function p(e,t,n){var r=0,a=s(e);if("m"==a.f||"a"==a.f){if(e.a>0&&t.a<=0)return-1;if(t.a>0&&e.a<=0)return 1;r=e.a-t.a}if(0==r){if(e.b>0&&t.b<=0)return-1;if(t.b>0&&e.b<=0)return 1;r=e.b-t.b}return n||0!=r||(r=e.n-t.n),r}if("WS"in e){var h=$("body"),v=$("#live-container"),g=v.data(),R=("https:"===location.protocol?"wss":"ws")+"://"+location.host+"/ws",b={333:.33,444:.22,555:.14,"333oh":.3,clock:.3,minx:.18,default:.42},E={},S={OPEN:0,FINISHED:1,LIVE:2},w=new WS(R);w.threshold=55e3,w.on("connect",function(){h.removeClass("disconnected"),w.send({type:"competition",competitionId:N.c}),0==N.results.length&&n(),w.send({type:"result",action:"rounds"}),A.showMessage&&w.send({type:"chat",action:"fetch"})}).on("disconnect",function(){h.addClass("disconnected")}).on("*",function(e,t){t&&t.onlineNumber&&k.dispatch("UPDATE_ONLINE_NUMBER",t.onlineNumber)}).on("users",function(e){U=e}).on("result.new",function(e){k.dispatch("NEW_RESULT",e),t(e,"new")}).on("result.update",function(e){k.dispatch("UPDATE_RESULT",e),t(e,"update")}).on("result.all",function(e){k.dispatch("UPDATE_RESULTS",e)}).on("round.all",function(e){k.dispatch("UPDATE_ROUNDS",e)}).on("round.update",function(e){k.dispatch("UPDATE_ROUND",e)}).on("message.recent",function(e){A.showMessage&&k.dispatch("RECENT_MESSAGES",e)}).on("message.new",function(e){A.showMessage&&V(e)}).on("message.disable",function(e){A.disableChat=e}).on("record.current",function(e){E=e}),Vue.use(VueRouter),Vue.use(Vuex),Vue.filter("decodeResult",u);var N={onlineNumber:0,user:{},c:0,events:[],filters:[],params:{event:"",round:"",filter:"all"},loading:!1,loadingUserResults:!1,results:[],userResults:[],messages:[],staticMessages:[]},x=Date.now(),D={},I={},U={},T={},_={CHANGE_PARAMS:function(e,t){e.params=t},UPDATE_ROUNDS:function(e,t){t.forEach(function(e){$.extend(I[e.e][e.i],e)}),x=Date.now()},UPDATE_ROUND:function(e,t){$.extend(I[t.e][t.i],t)},NEW_RESULT:function(e,t){if(t.c==e.c&&t.e==e.params.e&&t.r==e.params.r){t.p="",t.isNew=!0;var n=e.results,r=l(n,t);n.splice(r,0,t),f(n,t)}},UPDATE_RESULT:function(e,t){if(t.c==e.c&&t.e==e.params.e&&t.r==e.params.r){var n=e.results,r=0,s=n.length;for(t.p="",t.isNew=!0;r<s;r++)if(n[r].i==t.i){n[r]=t;break}n.sort(p),f(n,t)}},UPDATE_RESULTS:function(e,t){t.sort(p),f(t,{}),e.results=t,e.loading=!1},UPDATE_USER_RESULTS:function(e,t){e.userResults=t,e.loadingUserResults=!1},LOADING_RESULTS:function(e){e.loading=!0,e.results=[]},LOADING_USER_RESULTS:function(e){e.loadingUserResults=!0,e.userResults=[]},RECENT_MESSAGES:function(e,t){var n={};e.messages.forEach(function(e){n[e.id]=e.id}),t.forEach(function(t){t.type="normal",n[t.id]||e.messages.push(t)}),Vue.nextTick(function(){V({},!0)})},NEW_MESSAGE:function(e,t){(t.id||t.isSelf)&&(e.messages.push(t),e.messages.length>1e3&&e.messages.splice(0,1))},UPDATE_ONLINE_NUMBER:function(e,t){e.onlineNumber=t}};$.extend(N,g),g.liveStreamUrl&&N.staticMessages.push({id:+new Date,type:"static",user:{name:"System"},time:Math.floor(+new Date/1e3),content:'<a href="'+g.liveStreamUrl+'" target="_blank">'+g.liveStreamUrl+"</a>"});var A={enableEntry:!0,showMessage:!0,alertResult:!0,alertRecord:!0,disableChat:!1},y=window.store.get("live_options");y&&y.disableChat&&delete y.disableChat,$.extend(A,y),N.events.forEach(function(e){D[e.i]=e,I[e.i]={},e.rs.forEach(function(t){I[e.i][t.i]=t,T.e||2!=t.s||(T.e=e.i,T.r=t.i)})}),T.e||(T={e:N.params.e,r:N.params.r});var M={methods:{getRecordClass:function(e){return"NR"==e||"WR"==e?"record-"+e.toLowerCase():"record-cr"},getEventName:function(e){var t=r(e);return t&&t.name},getRoundName:function(e){var t=s(e);return t&&t.name},getUser:function(e){return a(e)},getResultDetail:function(e){var t,n,r=[];for(t=0;t<5;t++)n=u(e.v[t],e.e),n=(n+"            ").slice(0,"333mbo"===e.e||"333mbf"===e.e?13:8),r.push(n);return"<pre>"+r.join("   ")+"</pre>"}},vuex:{getters:{canChangeRoundSettings:function(e){return"WCA"!=e.type||e.user.isDelegate||e.user.isAdmin},hasPermission:function(e){var t=e.user;return t.isOrganizer||t.isDelegate||t.isAdmin||t.isScoreTaker},eventName:function(e){var t=r(e.params);return t&&t.name},roundName:function(e){var t=s(e.params);return t&&t.name},events:function(e){return e.events},e:function(e){return e.params.e},r:function(e){return e.params.r},currentRound:function(e){return s(e.params)},isCurrentRoundOpen:function(e){var t=s(e.params);return 1!=t.s},results:function(e){return e.results},loading:function(e){return e.loading},userResults:function(e){return e.userResults},loadingUserResults:function(e){return e.loadingUserResults},filters:function(e){return e.filters},onlineNumber:function(e){return e.onlineNumber}}}},k=new Vuex.Store({state:N,mutations:_});Vue.mixin(M);var C=Vue.extend({template:"#live-container-template",store:k,data:function(){return{options:A,currentUser:{}}},watch:{"options.disableChat":function(e){w.send({type:"chat",action:"disable",disable_chat:e})},"options.enableEntry":function(){window.store.set("live_options",this.options)},"options.showMessage":function(){window.store.set("live_options",this.options)},"options.alertResult":function(){window.store.set("live_options",this.options)},"options.alertRecord":function(){window.store.set("live_options",this.options)}},methods:{showOptions:function(){$("#options-modal").modal()},checkRounds:function(e){var t=!0;this.events.forEach(function(e){e.rs.forEach(function(e){e.s!=S.FINISHED&&(t=!1)})}),t||(e.preventDefault(),alert("请确保所有轮次已结束再导出！"))}},components:{chat:{props:["options"],data:function(){return{message:""}},vuex:{getters:{messages:function(e){return e.messages},staticMessages:function(e){return e.staticMessages}}},template:"#chat-template",methods:{send:function(e){var t=this;""!=t.message.trim()&&(w.send({type:"chat",action:"send",content:t.message,params:N.params}),V({user:N.user,content:t.message,isSelf:!0},!0),t.message="")}},components:{message:{props:["message"],template:"#message-template",filters:{formatTime:function(e){return e?moment(new Date(1e3*e)).format("MM-DD HH:mm:ss"):""}},components:{"static-message":{props:["message"],template:"#static-message-template"},"normal-message":{props:["message"],template:"#normal-message-template"},"result-message":{props:["message","result"],template:"#result-message-template"}}}}},result:{props:["options"],data:function(){return{eventRound:null,filter:"all",current:{v:[]},co:0,tl:0,f:"",n:0,page:1,limit:300}},computed:{offset:function(){return(this.page-1)*this.limit},totalPage:function(){return Math.ceil(this.results.length/this.limit)}},watch:{"$store.state.params":function(e){var t=this;t.eventRound={e:e.e,r:e.r},t.filter=e.filter,t.page=1;var n=s(e);t.co=n.co,t.tl=n.tl,t.n=n.n,t.f=n.f}},ready:function(){var e=this;e.eventRound={e:T.e,r:T.r};var t=s(e);e.co=t.co,e.tl=t.tl,e.n=t.n,e.f=t.f},template:"#result-template",methods:{hasAverage:function(e){var t=s(this);return"a"==t.f||"m"==t.f||e&&d(t.e)&&"3"==t.f},showRoundSettings:function(){$("#round-settings-modal").modal()},saveRoundSettings:function(){var e,t=this,n=["co","tl","n"];for(e=0;e<n.length;e++)if($("#"+n[e]).parent().removeClass("has-error"),isNaN(t[n[e]]))return void $("#"+n[e]).parent().addClass("has-error");$("#f").parent().removeClass("has-error"),""!=t.f?w.send({type:"result",action:"round",round:{event:N.params.e,id:N.params.r,cut_off:t.co,time_limit:t.tl,format:t.f,number:t.n}}):$("#f").parent().addClass("has-error")},closeRound:function(){return this.current={v:[]},this.checkEmptyResults()?!(!this.checkRepeatedResults()&&!confirm("本轮成绩有疑似重复录入的成绩，确定结束本轮？"))&&(w.send({type:"result",action:"round",round:{event:N.params.e,id:N.params.r,status:1}}),n(),void $("#round-settings-modal").modal("hide")):(alert("本轮成绩有不应出现的空白成绩，请检查！"),!1)},openRound:function(){w.send({type:"result",action:"round",round:{event:N.params.e,id:N.params.r,status:0}}),n(),$("#round-settings-modal").modal("hide")},exportScoreCard:function(){var e=$("#export-scord-card-form");e.find(".event").val(this.e),e.find(".round").val(this.r),e.submit()},refreshCompetitors:function(){w.send({type:"result",action:"refresh",round:{event:N.params.e,id:N.params.r}})},goToUser:function(e){this.$parent.currentUser=e,$("#user-results-modal").modal("show"),k.dispatch("LOADING_USER_RESULTS"),$.ajax({url:location.pathname+"/userResults",data:{user:e},dataType:"json",success:function(e){0==e.status&&k.dispatch("UPDATE_USER_RESULTS",e.data)}})},edit:function(e){this.hasPermission&&A.enableEntry&&this.isCurrentRoundOpen&&(this.current=JSON.parse(JSON.stringify(e)),this.$nextTick(function(){$(".input-panel-result input").eq(0).focus()}))},changeParams:function(){k.dispatch("CHANGE_PARAMS",{e:this.eventRound.e,r:this.eventRound.r,filter:this.filter}),Date.now()-x>3e5&&w.send({type:"result",action:"rounds"})},isAdvanced:function(e){if("all"!=this.filter)return!1;if("c"==e.r||"f"==e.r)return e.b>0&&e.p<=3;var t;for(t=0;t<D[e.e].rs.length;t++)if(D[e.e].rs[t].i==e.r&&D[e.e].rs[t+1])return e.b>0&&e.p<=D[e.e].rs[t+1].n;return!1},checkEmptyResults:function(){var e,t,n,r,s=this,a=s.currentRound,i=a.f,o=a.co,u="333fm"===s.e?1:100,c="a"==i||""==i?5:"m"==i?3:parseInt(i),l="a"==a.f?2:1,f=s.results,d=0,m=f.length;for(d=0;d<m;d++)if(t=f[d],n=!1,0!=t.b)for(e=0;e<c;e++)if(r=0==t.v[e],o>0){if(e<l){if(t.v[e]>0&&t.v[e]/u<o)n=!0;else if(r)return!1}else if(n!=!r)return!1}else if(r)return!1;return!0},checkRepeatedResults:function(){var e=this.results,t=0,n=e.length;for(t=0;t<n;t++)if(e[t].isRepeated)return!1;return!0}},components:{"input-panel":{props:["result"],data:function(){return{hasError:!1,breakRecord:!1,lastIndex:null,currentIndex:null,competitor:{name:""},v:[0,0,0,0,0],best:0,worst:0,average:0,searchText:"",searching:!1,selectedIndex:0}},computed:{competitors:function(){var e=this,t=e.searchText.toLowerCase();return e.results.filter(e.filterCompetitors.bind(e)).sort(function(e,n){if(!/^\d+$/.test(t)&&!/^\d{4}[A-Z]+\d*$/i.test(t)){var r=a(e.n).name.toLowerCase().indexOf(t)-a(n.n).name.toLowerCase().indexOf(t);return 0==r&&(r=a(e.n).name<a(n.n).name?-1:1),r}return e.n-n.n}).slice(0,5)}},watch:{round:function(){this.searchText=""},event:function(){this.searchText=""},result:function(e){var t=this;t.competitor=a(e.n),t.v=e.v,t.searchText=e.n||""},searchText:function(e){this.selectedIndex=0,""==e&&(this.result={v:[]})}},attached:function(){var e=this;$(window).on("resize",function(){e.$el.style.width=e.$el.parentNode.clientWidth-30+"px"}).trigger("resize")},methods:{isDisabled:function(e){var t=this,n=t.result;if(!n||!n.i||!this.$parent.isCurrentRoundOpen)return!0;var r=I[t.e][t.r],s="333fm"===t.e?1:100;if(r.co>0){for(var a="a"==r.f?2:1,i=!1,o=0;o<a;o++)if(t.result.v[o]>0&&t.result.v[o]/s<r.co){i=!0;break}return!(i||e<a)}return!1},keydown:function(e){var t=e.which,n=this;switch(t){case 107:case 40:case 38:case 9:e.shiftKey||107==t||38==t?$(".result-input:not([disabled])").last().focus():$(".result-input:not([disabled])").first().focus();break;case 13:n.save()}},save:function(){var e=this,t=e.result;t.v.forEach(function(n,r){e.isDisabled(r)&&(t.v[r]=0)}),i(e.result);var n={type:"result",action:"update",result:{id:t.i,value1:t.v[0],value2:t.v[1],value3:t.v[2],value4:t.v[3],value5:t.v[4],best:t.b,average:t.a,regional_single_record:t.sr,regional_average_record:t.ar}};e.checkResult(!0)&&(e.result={v:[]},$("#input-panel-name").focus(),Vue.nextTick(function(){w.safeSend(n,"result.update",n.result.id)}),e.breakRecord=!1,e.hasError=!1)},checkResult:function(e){var t=this,n=[],r=0,s=t.result;if(i(s),t.hasError=!1,t.breakRecord=!1,s.v.forEach(function(e){e>0&&(r+=e,n.push(e))}),n.length>3){var o=r/n.length,u=Math.sqrt(n.map(function(e){return Math.pow(e-o,2)}).reduce(function(e,t){return e+t},0)/n.length),c=b[s.e]||b.default;if(u/o>c&&(t.hasError=!0,e&&!confirm("成绩标准差过大，确定是否正确输入了？")))return!1}const l=E[a(s.n).region][s.e];return!(l&&(s.a>0&&s.a<=l.a||s.b>0&&s.b<=l.b)&&(t.breakRecord=!0,e&&!confirm("该成绩可能打破纪录，确定是否正确输入了？")))},filterCompetitors:function(e){var t=this,n=t.searchText.trim();return""!=n&&(/^\d+$/.test(n)?!!e.n.toString().match(n):/^\d{4}[A-Z]+\d*$/i.test(n)?!!a(e.n).wcaid.toUpperCase().match(n.toUpperCase()):!!a(e.n).name.match(new RegExp(n,"i")))},enter:function(){this.competitors[this.selectedIndex]&&this.selectCompetitor(this.competitors[this.selectedIndex])},up:function(){var e=this.competitors.length;e&&(this.selectedIndex=(this.selectedIndex+e-1)%e)},down:function(){var e=this.competitors.length;e&&(this.selectedIndex=(this.selectedIndex+1)%e)},selectCompetitor:function(e){this.name=e.n,this.$parent.edit(e)}},vuex:{getters:{inputNum:function(e){var t=e.params,n=s(t),r=n&&n.f;switch(r){case"1":return 1;case"2":return 2;case"3":case"m":return 3;default:return 5}},minInputNum:function(e){var t=e.params,n=s(t),r=n&&n.f;switch(r){case"1":return 1;case"2":return 2;case"3":return 3;case"m":return 1;default:return 2}}}},template:"#input-panel-template",components:{"result-input":{props:["value","index"],data:function(){return{subIndex:2,tried:"",solved:"",time:""}},watch:{time:function(){this.calculateValue()},tried:function(){this.calculateValue()},solved:function(){this.calculateValue()},"$parent.result.i":function(){var e=this,t=u(e.value,e.e);if("333mbf"===e.e)if(e.subIndex=0,t.indexOf("/")>-1){var n=t.match(/^(\d+)\/(\d+) (.+)$/);e.solved=n[1],e.tried=n[2],e.time=n[3].replace(/[:\.]/g,"")}else e.solved=e.tried="",e.time=t;else e.time=t.replace(/[:\.]/g,""),e.subIndex=2}},methods:{calculateValue:function(){var e=this,t=s(e);e.value=o(e.formatTime(e.time),e.e,!1,e.tried,e.solved),t.tl>0&&"333mbf"!=e.e&&"333fm"!=e.e&&e.value/100>=t.tl&&(e.time="DNF"),"333fm"===e.e&&e.value>80&&(e.time="DNF")},formatTime:function(e){if("DNF"==e||"DNS"==e||""==e||"333fm"==this.e)return e;var t=e.length>4?parseInt(e.slice(0,-4)):0,n=e.length>2?parseInt(e.slice(0,-2).slice(-2)):0,r=parseInt(e.slice(-2));if("333mbf"===this.e){if(""==this.solved||""==this.tried)return"";t=n,n=r,r=0}return[t?t+":":"",n+".",r].join("")},focus:function(e){this.subIndex=e,this.$parent.currentIndex=this.index},blur:function(e){this.$parent.currentIndex=null,this.$parent.lastIndex=null,this.$parent.checkResult()},keydown:function(e,t){var n=e.which,r=this,s=r[t],a=r.$parent.lastIndex==r.$parent.currentIndex;switch(n){case 68:case 111:r.time="DNF";break;case 106:case 83:r.time="DNS";break;case 8:case 109:a&&"DNF"!=r.time&&"DNS"!=r.time||("DNF"!==r.time&&"DNS"!==r.time||(r.solved=r.tried=r.time=""),s=""),r.$parent.lastIndex=r.$parent.currentIndex,r[t]=s.slice(0,-1);break;case 107:case 38:case 9:if(e.shiftKey||107==n||38==n){var i=$(e.target),o=$(".result-input:not([disabled])"),u=o.index(i);u>0&&o.eq(u-1).focus();break}case 40:case 13:i=$(e.target),o=$(".result-input:not([disabled])"),u=o.index(i);u<o.length-1?o.eq(u+1).focus():$("#save").focus();break;case 96:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:n-=48;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:if(s.length>=6&&a)break;if(a&&"DNF"!=r.time&&"DNS"!=r.time||("DNF"!==r.time&&"DNS"!==r.time||(r.solved=r.tried=r.time=""),s=""),("333fm"===r.e||r.subIndex<2)&&s.length>=2)break;if("333mbf"===r.e&&s.length>=4)break;s+=n-48,r[t]=s,a||(r.$parent.lastIndex=r.$parent.currentIndex);break;default:e.preventDefault()}}},template:"#result-input-template"}}}}}}}),L=new VueRouter;L.map({"/event/:e/:r/:filter":{component:{}}}),k.watch(function(e){return e.params},function(e){L.go(["/event",e.e,e.r,e.filter].join("/")),n()},{deep:!0,sync:!0}),L.afterEach(function(e){var t=e.to.params;t.e==N.params.e&&t.r==N.params.r&&t.filter==N.params.filter||k.dispatch("CHANGE_PARAMS",t)}),L.redirect({"*":["/event",T.e,T.r,N.params.filter].join("/")}),L.start(C,v.get(0));var O,P,V=(O=$(".message-container:not(.static-message-container)"),P=O.find("ul"),function(e,t){0==O.length&&(O=$(".message-container:not(.static-message-container)"),P=O.find("ul")),e.type=e.type||"normal",k.dispatch("NEW_MESSAGE",e),(t||O.height()+O.scrollTop()>P.height()-30)&&Vue.nextTick(function(){O.scrollTop(P.height())})})}else alert("Your browser doesn't support, please upgrade!")})(this);